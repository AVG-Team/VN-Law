import{r as s,i as L,j as e,k as F,B as g,l as q,Q as O}from"./index-D8y7tREh.js";import{f as U,c as G}from"./authClient-CRicmCU6.js";import{h as E,S as z}from"./react-google-recaptcha-v3.esm-BAC1LrXW.js";import{B as c,G as N,T as J}from"./Grid-C3qmDbmo.js";import{T as C}from"./Typography-DHzf4aXy.js";import{T as P,L as X,a as A,F as V}from"./EyeIcon-BS77Z83k.js";import{B as b}from"./Button-Q1odovWi.js";import"./index-VWaDGczM.js";import"./axiosClient-f7rFmG3x.js";import"./axios-B6xwUs71.js";import"./Paper-CMmxJBy4.js";function $(){const[t,m]=s.useState(""),a=L(),[x,r]=s.useState(!1),[f,l]=s.useState(null),p="6LfJywMqAAAAAEk2nw2ghStxujeIzedVb3xOvW6U",o=i=>{l(i)};async function v(i){i.preventDefault();try{r(!0);const d=await U({email:t,recaptchaToken:f});g.success(d.message,{onClose:()=>a("/dang-nhap"),autoClose:1e3,buttonClose:!1})}catch(d){console.error(d),g.error(d.message)}finally{r(!1)}}function k(i){m(i.target.value)}return e.jsxs(c,{className:"px-5 mx-auto rounded shadow-2xl py-7 sm:w-6/12 lg:w-4/12",children:[e.jsxs("div",{className:"mb-2 text-center",children:[e.jsx("div",{className:"flex justify-center ",children:e.jsx("img",{loading:"lazy",className:"!w-2/4 ",src:F,alt:"Logo"})}),e.jsx(C,{variant:"h6",className:" !text-sm italic !text-blue-gray-950",children:"Tri Thức Pháp Luật Việt Nam"})]}),e.jsx(E,{reCaptchaKey:p,language:"vi",children:e.jsxs(c,{component:"form",validate:"true",onSubmit:v,className:"mt-1 text-center",children:[e.jsx(z,{onVerify:o}),e.jsx(P,{margin:"normal",fullWidth:!0,id:"email",type:"email",label:"Email",name:"email",value:t,onChange:k,autoComplete:"email",autoFocus:!0,required:!0}),e.jsxs(b,{type:"submit",variant:"contained",className:"!mx-auto !my-8",children:[x&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Xác nhận"]})]})}),e.jsx(N,{container:!0,className:"justify-between",children:e.jsxs(N,{item:!0,className:"flex flex-row",children:[e.jsx(C,{className:"left-0 px-1 pt-[2px]",variant:"body2",children:"Bạn muốn đăng nhập?"}),e.jsx(X,{underline:"none",className:"!mt-[2px]",href:"/dang-nhap",variant:"body2",children:"Đăng nhập"})]})})]})}function Q({token:t}){const m=L(),[a,x]=s.useState({}),[r,f]=s.useState(!1),[l,p]=s.useState(!1),[o,v]=s.useState(!1),[k,i]=s.useState(!1),[d,S]=s.useState(!1),[j,B]=s.useState({password:"",confirmPassword:""}),[M,R]=s.useState(null),I="6LfJywMqAAAAAEk2nw2ghStxujeIzedVb3xOvW6U",W=w=>{R(w)};(t==null||t==="")&&g.error("Token phải là bắt buộc",{onClose:()=>m("/dang-nhap"),autoClose:1e3,buttonClose:!1});async function D(w){w.preventDefault();const{password:n,confirmPassword:u}=j,h={};if(n.trim()?n.length<8&&(h.password="Mật khẩu mới phải có ít nhất 8 kí tự"):h.password="Mật khẩu mới là bắt buộc",u.trim()?u!==n&&(h.confirmPassword="Mật khẩu không khớp"):h.confirmPassword="Nhập lại mật khẩu mới là bắt buộc",x(h),Object.keys(h).length===0)try{S(!0);const y=await G({password:n,token:t,recaptchaToken:M});g.success(y.message,{onClose:()=>m("/dang-nhap"),autoClose:1e3,buttonClose:!1})}catch(y){g.error(y.message,{autoClose:1e3,buttonClose:!1}),console.error("Fetch reset password error: ",y.message)}finally{S(!1)}}function T(w){const{name:n,value:u}=w.target;B({...j,[n]:u}),n==="password"?p(u!==""):n==="confirmPassword"&&i(u!=="")}function H(){f(!r)}function K(){v(!o)}return e.jsxs(c,{className:"w-full px-5 py-6 mx-auto rounded shadow-2xl sm:w-8/12 lg:w-4/12",children:[e.jsxs("div",{className:"mb-2 text-center",children:[e.jsx("div",{className:"flex justify-center ",children:e.jsx("img",{loading:"lazy",className:"!w-2/4 ",src:F,alt:"Logo"})}),e.jsx(C,{variant:"h6",className:" !text-sm italic !text-blue-gray-950",children:"Tri Thức Pháp Luật Việt Nam"})]}),e.jsx(E,{reCaptchaKey:I,language:"vi",children:e.jsxs(c,{component:"form",validate:"true",onSubmit:D,className:"flex flex-col mt-1 text-center",children:[e.jsx(z,{onVerify:W}),e.jsx(P,{margin:"normal",name:"password",label:"Mật khẩu mới",type:r?"text":"password",id:"password",onChange:T,value:j.password,InputProps:{endAdornment:l&&e.jsx(b,{className:"eye-button",onClick:H,children:r?e.jsx(A,{className:"block w-5 h-5 text-black","aria-hidden":"true"}):e.jsx(V,{className:"block w-5 h-5 text-black","aria-hidden":"true"})})}}),a.password&&e.jsx(c,{className:"text-sm text-left text-red-500",children:a.password}),e.jsx(P,{margin:"normal",name:"confirmPassword",label:"Nhập lại mật khẩu mới",type:o?"text":"password",id:"confirmPassword",onChange:T,value:j.confirmPassword,InputProps:{endAdornment:k&&e.jsx(b,{className:"eye-button",onClick:K,children:o?e.jsx(A,{className:"block w-5 h-5 text-black","aria-hidden":"true"}):e.jsx(V,{className:"block w-5 h-5 text-black","aria-hidden":"true"})})}}),a.confirmPassword&&e.jsx(c,{className:"text-sm text-left text-red-500",children:a.confirmPassword}),e.jsxs(b,{type:"submit",variant:"contained",className:"!mx-auto !my-8",children:[d&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Xác nhận"]})]})})]})}function ie(t){const m=q(),[a,x]=s.useState("forgot-password"),[r,f]=s.useState(""),l=t.title;s.useEffect(()=>{document.title=l?`${l}`:"Trang không tồn tại";const o=new URLSearchParams(window.location.search);x(o.get("type")),f(o.get("token"))},[l]);function p(){switch(a){case"doi-mat-khau":return e.jsx(Q,{token:r});default:return e.jsx($,{})}}return e.jsxs(J,{theme:m,children:[e.jsx(O,{}),e.jsx(N,{container:!0,component:"main",className:"min-h-screen",alignItems:"center",justifyContent:"center",children:e.jsx(N,{item:!0,xs:12,elevation:6,children:e.jsx(c,{className:"mx-4 my-5",children:p()})})})]})}export{ie as default};
